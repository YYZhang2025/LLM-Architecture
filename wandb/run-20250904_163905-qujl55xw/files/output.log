[32mModel initialized. Number of parameters: [0m[1;32m27368448[0m
/Users/yuyang/Desktop/Projects/LLM-Architecture/.venv/lib/python3.12/site-packages/torch/utils/data/dataloader.py:684: UserWarning: 'pin_memory' argument is set as true but not supported on MPS now, then device pinned memory won't be used.
  warnings.warn(warn_msg)
Step 10/100, Loss: 8.8748
Sample input ids: tensor([[ 192,  189, 4494,   17,  329,  317,  185,  438, 2452,  185, 1043,  950,
           19,  242,  498,  383,  267,  193,  252,  232, 1108,  585,   17,  513,
          418,  278, 1370, 1172,  411,    5,  585, 1387,  232,   46,  854, 1065,
          383,  189, 4494, 1522,  206,  438, 2254,  185, 1359, 2068,   17,  345,
          585, 5305, 2485,  193,  252,  232, 1003,  366,  239,  411,    5,  206,
          438,  636,  193,  252,  232,  982,  320,  185, 4494, 1007, 3041,  833,
          192,  893, 1522,  242, 6144,  267, 1100,  193,  252,  232, 6067,  821,
           17,  327,  659,  333,    5,  585,  855,  409,  193,  362,  450,  192,
          189,  460,   19,  266,  787, 1540,  602,  189,  734,  438,  193,  271,
         4494,   19,  266, 5305, 1149,  602,  239,  193, 3816,  362,  338,  192,
          637,   19,    5,    5,    5,  365,  373,  185,  334,   17,  338,  210,
          185, 2365,  412,  339,  532,   19,  266,  295,  185, 2837,  316,  329,
          441,  192,  253,   19,  532,  468,  253,  267, 2837,  523,  257,  193,
         1046,  312, 2104,   19,  266,  295,  185,  275,  878,  193,  516,  267,
          347,  312,  358,   19,    5,  319,  257,   17,  532,  401,  296,  507,
          267, 2837,   19,  266,  484,  192, 1201,   19,  532,  442, 1502,  243,
          267,  643,   17,  345,  267, 2837,  210,  296,  338,   19,  266,  478,
          267,  347,  774,  292,  295, 1413,  239,   17,  345,  292,  295,  296,
           19,  532,  210,  430,  193,  386,  296,  590,  513,  192,  310,   19,
            5,  655,   17,  532,  762,  185, 1080, 1360,  515,  189, 1741,  643,
           19,  357,  210,  267,  327, 1404,   17,  439,   17,  520,  267, 2837,
            6,  439,  295, 3012,  239,  192, 1195,  532,  258,  185, 1216,  212,
          620,   19,  532,  210,  337,  312,  192,  476,  267, 2837,  193, 1022,
          439,  253,   19,  237,  408,  189, 2837,  392,  193, 1640,  312, 2104,
          367,  257,   19,    5,    5,    5,  365,  373,  185,  334,   17,  243,
          185,  495,  935,   17,  338,  566,  185,  327,  412,  339,  318,   19,
          266,  210,  355, 2317,  412,  594,  638,  671,  189, 3433,   19,  319,
          257,   17,  934,  520,  635,   17,  329,  317, 1202, 2244,  243,  189,
          751,   19,  318,  608,  185, 1986,  210, 1360,   19,    5,  318,  529,
          519,  192, 1175,  267,  323,  602,  189, 1986,   19,  266,  252,   17,
          232, 1109,   17,  265,  666,  543,   19,  321,  275, 1986,  366, 1360,
          349,  738,  323,  860,  267,  193,  252,   17,  232, 1169,  428, 1201,
           17,  318,   19,  733,  551,  250,  821,  676, 1072,  538,  333,    5,
          206, 1986,  486,  193,  239,  210,  314,  842,   19,  206,  794, 1462,
          193,  189,  938,  991,  809,   19,  423,  318,  193,  267,  323, 1445,
          821,  243,  403,  519,   19,  660,  189, 1986,  210,  813,   17,  189,
          569,  486,  419,  193,  292,  473,  312,  534,   19,    5,    5,    5,
          319,  257,   17,  185,  327,  412,  339,  318,  362,  192, 1613,  267,
          287,   17,  185, 1414, 3665,  339, 4934,   19, 4934,  566,  283,  185,
          275,  992, 1563,  243,  189,  460,   19,  318,  467,  192,  253,  258,
         4934,  193,  292,  295,  185,  583,  301,  377,  392,   19,    5,  232,
         1027, 4934,   17,  766,  320,  253,  349,  252,  318,   19, 4934,  872,
          830,  193,  252,   17,  232,  667,   17]], device='mps:0')
Sample next token ids: ...............................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................................
Traceback (most recent call last):
  File "/Users/yuyang/Desktop/Projects/LLM-Architecture/train_scripts/train_baseline.py", line 107, in <module>
    train(model_config, train_cfg, run)
  File "/Users/yuyang/Desktop/Projects/LLM-Architecture/train_scripts/train_baseline.py", line 54, in train
    batch_loss += loss.item()
                  ^^^^^^^^^^^
KeyboardInterrupt
